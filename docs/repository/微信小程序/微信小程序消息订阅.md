### <font style="color:rgb(34, 34, 34);">wx.</font>requestSubscribeMessage(Objecet object)
<font style="color:rgb(34, 34, 34);">调起客户端小程序订阅消息界面，返回用户订阅消息的操作结果。当用户勾选了订阅面板中的“总是保持以上选择，不再询问”时，模板消息会被添加到用户的小程序设置页，通过 </font>[wx.getSetting](https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.getSetting.html)<font style="color:rgb(34, 34, 34);"> 接口可获取用户对相关模板消息的订阅状态。</font>

**<font style="color:rgb(34, 34, 34);">注意事项</font>**<font style="color:rgb(34, 34, 34);">：</font>

+ <font style="color:rgb(34, 34, 34);">一次性模板id和永久模板id不可以同时使用</font>
+ <font style="color:rgb(34, 34, 34);">一次授权调用里，每个tmplld对应的模板标题不能存在相同，若出现相同，只保留一个。</font>
+ `<font style="color:rgb(34, 34, 34);">tmplId</font>`<font style="color:rgb(34, 34, 34);">作为需要订阅的消息模板的id的集合，一次调用最多可订阅3条消息。</font>

[具体详细见官网](https://developers.weixin.qq.com/miniprogram/dev/api/open-api/subscribe-message/wx.requestSubscribeMessage.html)

```javascript
wx.requestSubscribeMessage({
  tmplIds: [''],
  success: (res) => { },
  fail: (error) => { },
  complete: (e) => { }
})
```

**object.success回调函数**

+ **errMsg**——<font style="color:rgb(53, 53, 53);">接口调用成功时errMsg值为'requestSubscribeMessage:ok'</font>
+ **<font style="color:rgb(53, 53, 53);">[TEMPLATE_ID: string]</font>**<font style="color:rgb(53, 53, 53);">——[TEMPLATE_ID]是动态的键，即模板id，值包括'accept'、'reject'、'ban'、'filter'。'accept'表示用户同意订阅该条id对应的模板消息，'reject'表示用户拒绝订阅该条id对应的模板消息，'ban'表示已被后台封禁，'filter'表示该模板因为模板标题同名被后台过滤。</font>

**object.fail回调函数**

+ **errMsg**——接口调用失败错误信息
+ **errCode**——接口调用失败错误码

### <font style="color:rgb(34, 34, 34);">wx.getSetting(Object object)</font>
获取用户当前的设置<font style="color:rgb(34, 34, 34);">。</font>**<font style="color:rgb(34, 34, 34);">返回值中只会出现小程序已经向用户请求过的权限。</font>**

**<font style="color:rgb(34, 34, 34);">参数：</font>**

+ **<font style="color:rgb(53, 53, 53);">withSubscriptions——</font>**<font style="color:rgb(53, 53, 53);">是否同时获取用户订阅消息的订阅状态，默认不获取。注意：withSubscriptions 只返回用户勾选过订阅面板中的“总是保持以上选择，不再询问”的订阅消息。(类型为Boolean，默认值false)</font>
+ **<font style="color:rgb(53, 53, 53);">success——</font>**<font style="color:rgb(53, 53, 53);">接口调用成功的回调函数</font>
+ **<font style="color:rgb(53, 53, 53);">fail——</font>**<font style="color:rgb(53, 53, 53);">接口调用失败的回调函数</font>
+ **<font style="color:rgb(53, 53, 53);">complete——</font>**<font style="color:rgb(53, 53, 53);">接口调用结束的回调函数（调用成功、失败都会执行）</font>

**object.success回调函数**

+ **authSetting——**用户授权结果
+ **<font style="color:rgb(53, 53, 53);">subscriptionsSetting——</font>**<font style="color:rgb(53, 53, 53);">用户订阅消息设置，接口参数</font>`<font style="color:rgb(53, 53, 53);background-color:rgb(249, 249, 250);">withSubscriptions</font>`<font style="color:rgb(53, 53, 53);">值为</font>`<font style="color:rgb(53, 53, 53);background-color:rgb(249, 249, 250);">true</font>`<font style="color:rgb(53, 53, 53);">时才会返回。</font>
+ **<font style="color:rgb(53, 53, 53);">miniprogramAuthSetting——</font>**<font style="color:rgb(53, 53, 53);">在插件中调用时，当前宿主小程序的用户授权结果。</font>

```javascript
wx.getSetting({
  withSubscriptions: true,
  success: (res) => {
    console.log(res.authSetting)
    // res.authSetting = {
    //   "scope.userInfo": true,
    //   "scope.userLocation": true
    // }
    console.log(res.subscriptionsSetting)
    // res.subscriptionsSetting = {
    //   mainSwitch: true, // 订阅消息总开关
    //   itemSettings: {   // 每一项开关
    //     SYS_MSG_TYPE_INTERACTIVE: 'accept', // 小游戏系统订阅消息
    //     SYS_MSG_TYPE_RANK: 'accept'
    //     zun-LzcQyW-edafCVvzPkK4de2Rllr1fFpw2A_x0oXE: 'reject', // 普通一次性订阅消息
    //     ke_OZC_66gZxALLcsuI7ilCJSP2OJ2vWo2ooUPpkWrw: 'ban',
    //   }
    // }
  }
  fail:(error)=>{},
  complete:(e)=>{}
})
```

