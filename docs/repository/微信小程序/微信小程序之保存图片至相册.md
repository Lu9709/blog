# 微信小程序之保存图片至相册

保存到手机内可能需要在小程序内配置downFileLoad的合法域名地址。

```javascript
  saveQrCode(){
      uni.downloadFile({
        url: this.customerInfo.qrcode,//图片地址
        success: (res) => {
          //图片保存到本地
          uni.saveImageToPhotosAlbum({
            filePath: res.tempFilePath,
            success: ()=> {
              uni.hideLoading()
              uni.showModal({
                title: '提示',
                content: '二维码已保存到相册',
                showCancel: false,
              })
            },
            fail: (err) => {
              if (err.errMsg === "saveImageToPhotosAlbum:fail:auth denied" || err.errMsg === "saveImageToPhotosAlbum:fail auth deny" || err.errMsg === "saveImageToPhotosAlbum:fail authorize no response") {
                // 这边微信做过调整，必须要在按钮中触发，因此需要在弹框回调中进行调用
                uni.showModal({
                  title: '提示',
                  content: '需要您授权保存相册',
                  showCancel: false,
                  success: modalSuccess => {
                    wx.openSetting({
                      success(settingdata) {
                        console.log("settingdata", settingdata)
                        if (settingdata.authSetting['scope.writePhotosAlbum']) {
                          uni.showModal({
                            title: '提示',
                            content: '获取权限成功,再次点击图片即可保存',
                            showCancel: false,
                          })
                        } else {
                          uni.showModal({
                            title: '提示',
                            content: '获取权限失败，将无法保存到相册哦~',
                            showCancel: false,
                          })
                        }
                      },
                      fail(failData) {
                        console.log("failData", failData)
                      },
                      complete(finishData) {
                        console.log("finishData", finishData)
                      }
                    })
                  }
                })
              }
            },
            complete(res) {
              wx.hideLoading()
            }
          })
        }
      })
    }
```

